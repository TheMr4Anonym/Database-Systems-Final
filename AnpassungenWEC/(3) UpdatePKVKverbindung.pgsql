UPDATE worldenergyconsumption SET iso_code = 'AL' WHERE iso_code = 'ALB';
UPDATE worldenergyconsumption SET iso_code = 'DZ' WHERE iso_code = 'DZA';
UPDATE worldenergyconsumption SET iso_code = 'AMSA' WHERE iso_code = 'ASM';
UPDATE worldenergyconsumption SET iso_code = 'ANG' WHERE iso_code = 'AGO';
UPDATE worldenergyconsumption SET iso_code = 'AG' WHERE iso_code = 'ATG';
UPDATE worldenergyconsumption SET iso_code = 'RA' WHERE iso_code = 'ARG';
UPDATE worldenergyconsumption SET iso_code = 'ARU' WHERE iso_code = 'ABW';
UPDATE worldenergyconsumption SET iso_code = 'A' WHERE iso_code = 'AUT';
UPDATE worldenergyconsumption SET iso_code = 'AZ' WHERE iso_code = 'AZE';
UPDATE worldenergyconsumption SET iso_code = 'BS' WHERE iso_code = 'BHS';
UPDATE worldenergyconsumption SET iso_code = 'BRN' WHERE iso_code = 'BHR';
UPDATE worldenergyconsumption SET iso_code = 'BD' WHERE iso_code = 'BGD';
UPDATE worldenergyconsumption SET iso_code = 'BDS' WHERE iso_code = 'BRB';
UPDATE worldenergyconsumption SET iso_code = 'BY' WHERE iso_code = 'BLR';
UPDATE worldenergyconsumption SET iso_code = 'B' WHERE iso_code = 'BEL';
UPDATE worldenergyconsumption SET iso_code = 'BZ' WHERE iso_code = 'BLZ';
UPDATE worldenergyconsumption SET iso_code = 'BERM' WHERE iso_code = 'BMU';
UPDATE worldenergyconsumption SET iso_code = 'BHT' WHERE iso_code = 'BTN';
UPDATE worldenergyconsumption SET iso_code = 'RB' WHERE iso_code = 'BWA';
UPDATE worldenergyconsumption SET iso_code = 'BR' WHERE iso_code = 'BRA';
UPDATE worldenergyconsumption SET iso_code = 'BVI' WHERE iso_code = 'VGB';
UPDATE worldenergyconsumption SET iso_code = 'BRU' WHERE iso_code = 'BRN';
UPDATE worldenergyconsumption SET iso_code = 'BG' WHERE iso_code = 'BGR';
UPDATE worldenergyconsumption SET iso_code = 'BF' WHERE iso_code = 'BFA';
UPDATE worldenergyconsumption SET iso_code = 'BI' WHERE iso_code = 'BDI';
UPDATE worldenergyconsumption SET iso_code = 'K' WHERE iso_code = 'KHM';
UPDATE worldenergyconsumption SET iso_code = 'CAM' WHERE iso_code = 'CMR';
UPDATE worldenergyconsumption SET iso_code = 'CDN' WHERE iso_code = 'CAN';
UPDATE worldenergyconsumption SET iso_code = 'CV' WHERE iso_code = 'CPV';
UPDATE worldenergyconsumption SET iso_code = 'CAYM' WHERE iso_code = 'CYM';
UPDATE worldenergyconsumption SET iso_code = 'RCA' WHERE iso_code = 'CAF';
UPDATE worldenergyconsumption SET iso_code = 'TCH' WHERE iso_code = 'TCD';
UPDATE worldenergyconsumption SET iso_code = 'RCH' WHERE iso_code = 'CHL';
UPDATE worldenergyconsumption SET iso_code = 'CN' WHERE iso_code = 'CHN';
UPDATE worldenergyconsumption SET iso_code = 'CO' WHERE iso_code = 'COL';
UPDATE worldenergyconsumption SET iso_code = 'CGO' WHERE iso_code = 'COG';
UPDATE worldenergyconsumption SET iso_code = 'COOK' WHERE iso_code = 'COK';
UPDATE worldenergyconsumption SET iso_code = 'CR' WHERE iso_code = 'CRI';
UPDATE worldenergyconsumption SET iso_code = 'CI' WHERE iso_code = 'CIV';
UPDATE worldenergyconsumption SET iso_code = 'HR' WHERE iso_code = 'HRV';
UPDATE worldenergyconsumption SET iso_code = 'C' WHERE iso_code = 'CUB';
UPDATE worldenergyconsumption SET iso_code = 'CUR' WHERE iso_code = 'CYP';
UPDATE worldenergyconsumption SET iso_code = 'CY' WHERE iso_code = 'CZE';
UPDATE worldenergyconsumption SET iso_code = 'CZ' WHERE iso_code = 'COD';
UPDATE worldenergyconsumption SET iso_code = 'DK' WHERE iso_code = 'DNK';
UPDATE worldenergyconsumption SET iso_code = 'WD' WHERE iso_code = 'DMA';
UPDATE worldenergyconsumption SET iso_code = 'EC' WHERE iso_code = 'ECU';
UPDATE worldenergyconsumption SET iso_code = 'ET' WHERE iso_code = 'EGY';
UPDATE worldenergyconsumption SET iso_code = 'ES' WHERE iso_code = 'SLV';
UPDATE worldenergyconsumption SET iso_code = 'GQ' WHERE iso_code = 'GNQ';
UPDATE worldenergyconsumption SET iso_code = 'ER' WHERE iso_code = 'ERI';
UPDATE worldenergyconsumption SET iso_code = 'SD' WHERE iso_code = 'SWZ';
UPDATE worldenergyconsumption SET iso_code = 'FALK' WHERE iso_code = 'FLK';
UPDATE worldenergyconsumption SET iso_code = 'FO' WHERE iso_code = 'FRO';
UPDATE worldenergyconsumption SET iso_code = 'SF' WHERE iso_code = 'FIN';
UPDATE worldenergyconsumption SET iso_code = 'F' WHERE iso_code = 'FRA';
UPDATE worldenergyconsumption SET iso_code = 'FGU' WHERE iso_code = 'GUF';
UPDATE worldenergyconsumption SET iso_code = 'FPOL' WHERE iso_code = 'PYF';
UPDATE worldenergyconsumption SET iso_code = 'G' WHERE iso_code = 'GAB';
UPDATE worldenergyconsumption SET iso_code = 'WAG' WHERE iso_code = 'GMB';
UPDATE worldenergyconsumption SET iso_code = 'GE' WHERE iso_code = 'GEO';
UPDATE worldenergyconsumption SET iso_code = 'D' WHERE iso_code = 'DEU';
UPDATE worldenergyconsumption SET iso_code = 'GH' WHERE iso_code = 'GHA';
UPDATE worldenergyconsumption SET iso_code = 'GBZ' WHERE iso_code = 'GIB';
UPDATE worldenergyconsumption SET iso_code = 'GR' WHERE iso_code = 'GRC';
UPDATE worldenergyconsumption SET iso_code = 'GL' WHERE iso_code = 'GRL';
UPDATE worldenergyconsumption SET iso_code = 'WG' WHERE iso_code = 'GRD';
UPDATE worldenergyconsumption SET iso_code = 'GUAD' WHERE iso_code = 'GLP';
UPDATE worldenergyconsumption SET iso_code = 'GUAM' WHERE iso_code = 'GUM';
UPDATE worldenergyconsumption SET iso_code = 'GCA' WHERE iso_code = 'GTM';
UPDATE worldenergyconsumption SET iso_code = 'RG' WHERE iso_code = 'GIN';
UPDATE worldenergyconsumption SET iso_code = 'GUB' WHERE iso_code = 'GNB';
UPDATE worldenergyconsumption SET iso_code = 'RH' WHERE iso_code = 'HTI';
UPDATE worldenergyconsumption SET iso_code = 'HN' WHERE iso_code = 'HND';
UPDATE worldenergyconsumption SET iso_code = 'HK' WHERE iso_code = 'HKG';
UPDATE worldenergyconsumption SET iso_code = 'H' WHERE iso_code = 'HUN';
UPDATE worldenergyconsumption SET iso_code = 'IS' WHERE iso_code = 'ISL';
UPDATE worldenergyconsumption SET iso_code = 'RI' WHERE iso_code = 'IDN';
UPDATE worldenergyconsumption SET iso_code = 'IR' WHERE iso_code = 'IRN';
UPDATE worldenergyconsumption SET iso_code = 'IL' WHERE iso_code = 'ISR';
UPDATE worldenergyconsumption SET iso_code = 'I' WHERE iso_code = 'ITA';
UPDATE worldenergyconsumption SET iso_code = 'JA' WHERE iso_code = 'JAM';
UPDATE worldenergyconsumption SET iso_code = 'J' WHERE iso_code = 'JPN';
UPDATE worldenergyconsumption SET iso_code = 'KZ' WHERE iso_code = 'KAZ';
UPDATE worldenergyconsumption SET iso_code = 'EAK' WHERE iso_code = 'KEN';
UPDATE worldenergyconsumption SET iso_code = 'KG' WHERE iso_code = 'KGZ';
UPDATE worldenergyconsumption SET iso_code = 'LV' WHERE iso_code = 'LVA';
UPDATE worldenergyconsumption SET iso_code = 'RL' WHERE iso_code = 'LBN';
UPDATE worldenergyconsumption SET iso_code = 'LS' WHERE iso_code = 'LSO';
UPDATE worldenergyconsumption SET iso_code = 'LB' WHERE iso_code = 'LBR';
UPDATE worldenergyconsumption SET iso_code = 'LAR' WHERE iso_code = 'LBY';
UPDATE worldenergyconsumption SET iso_code = 'LT' WHERE iso_code = 'LTU';
UPDATE worldenergyconsumption SET iso_code = 'L' WHERE iso_code = 'LUX';
UPDATE worldenergyconsumption SET iso_code = 'MACX' WHERE iso_code = 'MAC';
UPDATE worldenergyconsumption SET iso_code = 'RM' WHERE iso_code = 'MDG';
UPDATE worldenergyconsumption SET iso_code = 'MW' WHERE iso_code = 'MWI';
UPDATE worldenergyconsumption SET iso_code = 'MAL' WHERE iso_code = 'MYS';
UPDATE worldenergyconsumption SET iso_code = 'MV' WHERE iso_code = 'MDV';
UPDATE worldenergyconsumption SET iso_code = 'RMM' WHERE iso_code = 'MLI';
UPDATE worldenergyconsumption SET iso_code = 'M' WHERE iso_code = 'MLT';
UPDATE worldenergyconsumption SET iso_code = 'MART' WHERE iso_code = 'MTQ';
UPDATE worldenergyconsumption SET iso_code = 'RIM' WHERE iso_code = 'MRT';
UPDATE worldenergyconsumption SET iso_code = 'MS' WHERE iso_code = 'MUS';
UPDATE worldenergyconsumption SET iso_code = 'MD' WHERE iso_code = 'MDA';
UPDATE worldenergyconsumption SET iso_code = 'MNTS' WHERE iso_code = 'MSR';
UPDATE worldenergyconsumption SET iso_code = 'MA' WHERE iso_code = 'MAR';
UPDATE worldenergyconsumption SET iso_code = 'MOC' WHERE iso_code = 'MOZ';
UPDATE worldenergyconsumption SET iso_code = 'MYA' WHERE iso_code = 'MMR';
UPDATE worldenergyconsumption SET iso_code = 'NAU' WHERE iso_code = 'NRU';
UPDATE worldenergyconsumption SET iso_code = 'NEP' WHERE iso_code = 'NPL';
UPDATE worldenergyconsumption SET iso_code = 'NL' WHERE iso_code = 'NLD';
UPDATE worldenergyconsumption SET iso_code = 'NZ' WHERE iso_code = 'NZL';
UPDATE worldenergyconsumption SET iso_code = 'RN' WHERE iso_code = 'NER';
UPDATE worldenergyconsumption SET iso_code = 'NGR' WHERE iso_code = 'NGA';
UPDATE worldenergyconsumption SET iso_code = 'NIUE' WHERE iso_code = 'NIU';
UPDATE worldenergyconsumption SET iso_code = 'KP' WHERE iso_code = 'PRK';
UPDATE worldenergyconsumption SET iso_code = 'MK' WHERE iso_code = 'MKD';
UPDATE worldenergyconsumption SET iso_code = 'NMIS' WHERE iso_code = 'MNP';
UPDATE worldenergyconsumption SET iso_code = 'N' WHERE iso_code = 'NOR';
UPDATE worldenergyconsumption SET iso_code = 'OM' WHERE iso_code = 'OMN';
UPDATE worldenergyconsumption SET iso_code = 'PK' WHERE iso_code = 'PAK';
UPDATE worldenergyconsumption SET iso_code = 'PA' WHERE iso_code = 'PAN';
UPDATE worldenergyconsumption SET iso_code = 'PY' WHERE iso_code = 'PRY';
UPDATE worldenergyconsumption SET iso_code = 'PE' WHERE iso_code = 'PER';
UPDATE worldenergyconsumption SET iso_code = 'RP' WHERE iso_code = 'PHL';
UPDATE worldenergyconsumption SET iso_code = 'PL' WHERE iso_code = 'POL';
UPDATE worldenergyconsumption SET iso_code = 'P' WHERE iso_code = 'PRT';
UPDATE worldenergyconsumption SET iso_code = 'PR' WHERE iso_code = 'PRI';
UPDATE worldenergyconsumption SET iso_code = 'Q' WHERE iso_code = 'QAT';
UPDATE worldenergyconsumption SET iso_code = 'REUN' WHERE iso_code = 'REU';
UPDATE worldenergyconsumption SET iso_code = 'RO' WHERE iso_code = 'ROU';
UPDATE worldenergyconsumption SET iso_code = 'R' WHERE iso_code = 'RUS';
UPDATE worldenergyconsumption SET iso_code = 'HELX' WHERE iso_code = 'SHN';
UPDATE worldenergyconsumption SET iso_code = 'KN' WHERE iso_code = 'KNA';
UPDATE worldenergyconsumption SET iso_code = 'WL' WHERE iso_code = 'LCA';
UPDATE worldenergyconsumption SET iso_code = 'SPMI' WHERE iso_code = 'SPM';
UPDATE worldenergyconsumption SET iso_code = 'WV' WHERE iso_code = 'VCT';
UPDATE worldenergyconsumption SET iso_code = 'WS' WHERE iso_code = 'WSM';
UPDATE worldenergyconsumption SET iso_code = 'SA' WHERE iso_code = 'SAU';
UPDATE worldenergyconsumption SET iso_code = 'SN' WHERE iso_code = 'SEN';
UPDATE worldenergyconsumption SET iso_code = 'SY' WHERE iso_code = 'SYC';
UPDATE worldenergyconsumption SET iso_code = 'SK' WHERE iso_code = 'SVK';
UPDATE worldenergyconsumption SET iso_code = 'SLO' WHERE iso_code = 'SVN';
UPDATE worldenergyconsumption SET iso_code = 'SOL' WHERE iso_code = 'SLB';
UPDATE worldenergyconsumption SET iso_code = 'SO' WHERE iso_code = 'SOM';
UPDATE worldenergyconsumption SET iso_code = 'RSA' WHERE iso_code = 'ZAF';
UPDATE worldenergyconsumption SET iso_code = 'ROK' WHERE iso_code = 'KOR';
UPDATE worldenergyconsumption SET iso_code = 'E' WHERE iso_code = 'ESP';
UPDATE worldenergyconsumption SET iso_code = 'CL' WHERE iso_code = 'LKA';
UPDATE worldenergyconsumption SET iso_code = 'SUD' WHERE iso_code = 'SDN';
UPDATE worldenergyconsumption SET iso_code = 'SME' WHERE iso_code = 'SUR';
UPDATE worldenergyconsumption SET iso_code = 'S' WHERE iso_code = 'SWE';
UPDATE worldenergyconsumption SET iso_code = 'CH' WHERE iso_code = 'CHE';
UPDATE worldenergyconsumption SET iso_code = 'RC' WHERE iso_code = 'TWN';
UPDATE worldenergyconsumption SET iso_code = 'TJ' WHERE iso_code = 'TJK';
UPDATE worldenergyconsumption SET iso_code = 'EAT' WHERE iso_code = 'TZA';
UPDATE worldenergyconsumption SET iso_code = 'RT' WHERE iso_code = 'TGO';
UPDATE worldenergyconsumption SET iso_code = 'TO' WHERE iso_code = 'TON';
UPDATE worldenergyconsumption SET iso_code = 'TT' WHERE iso_code = 'TTO';
UPDATE worldenergyconsumption SET iso_code = 'TN' WHERE iso_code = 'TUN';
UPDATE worldenergyconsumption SET iso_code = 'TR' WHERE iso_code = 'TUR';
UPDATE worldenergyconsumption SET iso_code = 'TM' WHERE iso_code = 'TKM';
UPDATE worldenergyconsumption SET iso_code = 'TUCA' WHERE iso_code = 'TCA';
UPDATE worldenergyconsumption SET iso_code = 'EAU' WHERE iso_code = 'UGA';
UPDATE worldenergyconsumption SET iso_code = 'UA' WHERE iso_code = 'UKR';
UPDATE worldenergyconsumption SET iso_code = 'UAE' WHERE iso_code = 'ARE';
UPDATE worldenergyconsumption SET iso_code = 'GB' WHERE iso_code = 'GBR';
UPDATE worldenergyconsumption SET iso_code = 'ROU' WHERE iso_code = 'URY';
UPDATE worldenergyconsumption SET iso_code = 'UZ' WHERE iso_code = 'UZB';
UPDATE worldenergyconsumption SET iso_code = 'VU' WHERE iso_code = 'VUT';
UPDATE worldenergyconsumption SET iso_code = 'YV' WHERE iso_code = 'VEN';
UPDATE worldenergyconsumption SET iso_code = 'VN' WHERE iso_code = 'VNM';
UPDATE worldenergyconsumption SET iso_code = 'WSA' WHERE iso_code = 'ESH';
UPDATE worldenergyconsumption SET iso_code = 'YE' WHERE iso_code = 'YEM';
UPDATE worldenergyconsumption SET iso_code = 'Z' WHERE iso_code = 'ZMB';
UPDATE worldenergyconsumption SET iso_code = 'ZW' WHERE iso_code = 'ZWE';

DELETE FROM worldenergyconsumption
WHERE iso_code NOT IN (
    SELECT code
    FROM public.country
);